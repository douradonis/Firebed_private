{% extends "base.html" %}
{% block title %}List{% endblock %}
{% block content %}
<h2>List of invoices / Excel</h2>
<div class="mb-3">
  <a class="btn btn-success" href="{{ url_for('list_invoices') }}?download=1">Download Excel</a>
  <a class="btn btn-secondary" href="{{ url_for('fetch') }}">Back to Fetch</a>
</div>

{% if table %}
  <div style="max-height:600px; overflow:auto; background:#fff; padding:8px; border-radius:6px;">
    <table class="table table-sm">
      <thead>
        <tr>
          {% for k in table[0].keys() %}
            <th>{{ k }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in table %}
          <tr>
            {% for v in row.values() %}
              <td style="white-space:pre-wrap">{{ v }}</td>
            {% endfor %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <div>No rows</div>
{% endif %}
{% endblock %}
